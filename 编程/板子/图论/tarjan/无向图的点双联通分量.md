~~~c++
#include<iostream>
#include<vector>
#include<algorithm>
using namespace std;
const int N=5e5+10,M=4e6+10;

int q[N],e[M],ne[M],idx;
int n,m;
int dfn[N],low[N],cnt;
int sta[N],top;
vector<int> ans[N];
int num;

void add(int a,int b){
    e[idx]=b;ne[idx]=q[a];q[a]=idx++;
}

void tarjan(int u,int fa){
    int son=0;
    dfn[u]=low[u]=++cnt;
    sta[++top]=u;
    for(int i=q[u];i!=-1;i=ne[i]){
        int j=e[i];
        if(!dfn[j]){
            tarjan(j,u);
            son++;
            low[u]=min(low[j],low[u]);
            if(low[j]>=dfn[u]){
                num++;
                while(1){
                    int to=sta[top];
                    ans[num].push_back(to);
                    top--;
                    if(to==j) break;
                }
                ans[num].push_back(u);
            }
        }
        else if(j!=fa){
            low[u]=min(low[u],dfn[j]);
        }
    }
    if(fa==0&&son==0) ans[++num].push_back(u);
}

int main(){
    ios::sync_with_stdio(false);
    cin.tie(0);cout.tie(0);
    cin>>n>>m;
    for(int i=0;i<=n;i++) q[i]=-1;
    for(int i=1;i<=m;i++){
        int a,b;cin>>a>>b;
        add(a,b);add(b,a);
    }
    for(int i=1;i<=n;i++){
        if(!dfn[i]) tarjan(i,0);
    }
    cout<<num<<'\n';
    for(int i=1;i<=num;i++) sort(ans[i].begin(),ans[i].end());
    sort(ans+1,ans+1+num);
    for(int i=1;i<=num;i++){
        cout<<ans[i].size()<<' ';
        for(int u:ans[i]){
            cout<<u<<' ';
        }
        cout<<'\n';
    }
    return 0;
}
~~~