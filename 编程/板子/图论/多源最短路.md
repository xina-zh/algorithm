```cpp
#include<iostream>
#include<queue>
#include<cstring>

using namespace std;
#define int long long
const int N=3e3+10,M=6e4+10;
const int inf=1e18+7;
int n,m;
int q[N],w[M],e[M],ne[M],idx;

typedef pair<int,int> pii;

void add(int a,int b,int c){
    e[idx]=b;w[idx]=c;ne[idx]=q[a];q[a]=idx++;
}
int height[N];
int cnt[N];
int st[N];
int dist[N];
int non=1e9;
bool spfa(){
    queue<int> que;
    for(int i=1;i<=n;i++){
        que.push(i);
        st[i]=1;
    }
    while(que.size()){
        int to=que.front();st[to]=0;
        que.pop();
        for(int i=q[to];i!=-1;i=ne[i]){
            int j=e[i];
            if(height[j]>w[i]+height[to]){
                height[j]=w[i]+height[to];
                cnt[j]=cnt[to]+1;
                if(!st[j]){
                    que.push(j);
                    st[j]=1;
                }
                if(cnt[j]>n+3){
                    return false;
                }
            }
        }
    }
    return true;
}
int get_dist(int u,int v){
    return height[u]-height[v];
}
void dijkstra(int start){
    for(int i=1;i<=n;i++) {
        dist[i]=inf;st[i]=0;
    }
    priority_queue<pii,vector<pii>,greater<pii>> que;
    que.push({0,start});
    dist[start]=0;
    while(que.size()){
        pii to=que.top();que.pop();
        int u=to.second;
        if(st[u]) continue;
        st[u]=1;
        for(int i=q[u];i!=-1;i=ne[i]){
            int j=e[i];
            int len=dist[u]+w[i]+get_dist(u,j);
            if(dist[j]>len){
                dist[j]=len;
                que.push({dist[j],j});
            }
        }
    }
    int ans=0;
    for(int i=1;i<=n;i++){
        if(i==start) continue;
        if(dist[i]>inf/2) dist[i]=non;
        else{
            dist[i]=dist[i]-height[start]+height[i];
        }
    }
    for(int i=1;i<=n;i++){
        ans+=i*dist[i];
    }
    cout<<ans<<'\n';
}
signed main(){
    ios::sync_with_stdio(false);
    cin.tie(0);cout.tie(0);
    cin>>n>>m;
    for(int i=1;i<=n;i++){
        height[i]=inf;
    }
    for(int i=0;i<=n;i++){
        q[i]=-1;
    }
    for(int i=1;i<=m;i++){
        int a,b,c;
        cin>>a>>b>>c;
        add(a,b,c);
    }
    if(!spfa()){
        cout<<-1;
        return 0;
    }
    for(int i=1;i<=n;i++){
        dijkstra(i);
    }
    return 0;
}
```